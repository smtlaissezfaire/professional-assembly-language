task :default => :compile

task :compile do
  Dir.glob("*.s").each do |file|
    basename = File.basename(file)

    sh "as -o #{basename}.o #{file} && ld -o #{basename} #{basename}.o"
  end
end

task :clean do
  sh "rm -f *.o"

  binaries = Dir.glob("*.s").map do |file|
    basename = File.basename(file)
  end

  sh "rm -f #{binaries.join(" ")}"
end